{"ast":null,"code":"import { monitor, addEventListener } from '@datadog/browser-core';\nexport function trackLocationChanges(onLocationChange) {\n  var stopHistoryTracking = trackHistory(onLocationChange).stop;\n  var stopHashTracking = trackHash(onLocationChange).stop;\n  return {\n    stop: function stop() {\n      stopHistoryTracking();\n      stopHashTracking();\n    }\n  };\n}\nexport function areDifferentLocation(currentLocation, otherLocation) {\n  return currentLocation.pathname !== otherLocation.pathname || !isHashAnAnchor(otherLocation.hash) && getPathFromHash(otherLocation.hash) !== getPathFromHash(currentLocation.hash);\n}\n\nfunction trackHistory(onHistoryChange) {\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  var originalPushState = history.pushState;\n  history.pushState = monitor(function () {\n    originalPushState.apply(this, arguments);\n    onHistoryChange();\n  }); // eslint-disable-next-line @typescript-eslint/unbound-method\n\n  var originalReplaceState = history.replaceState;\n  history.replaceState = monitor(function () {\n    originalReplaceState.apply(this, arguments);\n    onHistoryChange();\n  });\n  var removeListener = addEventListener(window, \"popstate\"\n  /* POP_STATE */\n  , onHistoryChange).stop;\n\n  var stop = function stop() {\n    removeListener();\n    history.pushState = originalPushState;\n    history.replaceState = originalReplaceState;\n  };\n\n  return {\n    stop: stop\n  };\n}\n\nfunction trackHash(onHashChange) {\n  return addEventListener(window, \"hashchange\"\n  /* HASH_CHANGE */\n  , onHashChange);\n}\n\nfunction isHashAnAnchor(hash) {\n  var correspondingId = hash.substr(1);\n  return !!document.getElementById(correspondingId);\n}\n\nfunction getPathFromHash(hash) {\n  var index = hash.indexOf('?');\n  return index < 0 ? hash : hash.slice(0, index);\n}","map":{"version":3,"sources":["../../../../src/domain/rumEventsCollection/view/trackLocationChanges.ts"],"names":[],"mappings":"AAAA,SAAS,OAAT,EAAkB,gBAAlB,QAAqD,uBAArD;AAEA,OAAM,SAAU,oBAAV,CAA+B,gBAA/B,EAA2D;AACvD,MAAM,mBAAmB,GAAK,YAAY,CAAC,gBAAD,CAAZ,CAAL,IAAzB;AACA,MAAM,gBAAgB,GAAK,SAAS,CAAC,gBAAD,CAAT,CAAL,IAAtB;AAER,SAAO;AACL,IAAA,IAAI,EAAE,gBAAA;AACJ,MAAA,mBAAmB;AACnB,MAAA,gBAAgB;AACjB;AAJI,GAAP;AAMD;AAED,OAAM,SAAU,oBAAV,CAA+B,eAA/B,EAA0D,aAA1D,EAAiF;AACrF,SACE,eAAe,CAAC,QAAhB,KAA6B,aAAa,CAAC,QAA3C,IACC,CAAC,cAAc,CAAC,aAAa,CAAC,IAAf,CAAf,IACC,eAAe,CAAC,aAAa,CAAC,IAAf,CAAf,KAAwC,eAAe,CAAC,eAAe,CAAC,IAAjB,CAH3D;AAKD;;AAED,SAAS,YAAT,CAAsB,eAAtB,EAAiD;AAC/C;AACA,MAAM,iBAAiB,GAAG,OAAO,CAAC,SAAlC;AACA,EAAA,OAAO,CAAC,SAAR,GAAoB,OAAO,CAAC,YAAA;AAC1B,IAAA,iBAAiB,CAAC,KAAlB,CAAwB,IAAxB,EAA8B,SAA9B;AACA,IAAA,eAAe;AAChB,GAH0B,CAA3B,CAH+C,CAO/C;;AACA,MAAM,oBAAoB,GAAG,OAAO,CAAC,YAArC;AACA,EAAA,OAAO,CAAC,YAAR,GAAuB,OAAO,CAAC,YAAA;AAC7B,IAAA,oBAAoB,CAAC,KAArB,CAA2B,IAA3B,EAAiC,SAAjC;AACA,IAAA,eAAe;AAChB,GAH6B,CAA9B;AAIQ,MAAM,cAAc,GAAK,gBAAgB,CAAC,MAAD,EAAO;AAAA;AAAP,IAA8B,eAA9B,CAAhB,CAAL,IAApB;;AACR,MAAM,IAAI,GAAG,SAAP,IAAO,GAAA;AACX,IAAA,cAAc;AACd,IAAA,OAAO,CAAC,SAAR,GAAoB,iBAApB;AACA,IAAA,OAAO,CAAC,YAAR,GAAuB,oBAAvB;AACD,GAJD;;AAKA,SAAO;AAAE,IAAA,IAAI,EAAA;AAAN,GAAP;AACD;;AAED,SAAS,SAAT,CAAmB,YAAnB,EAA2C;AACzC,SAAO,gBAAgB,CAAC,MAAD,EAAO;AAAA;AAAP,IAAgC,YAAhC,CAAvB;AACD;;AAED,SAAS,cAAT,CAAwB,IAAxB,EAAoC;AAClC,MAAM,eAAe,GAAG,IAAI,CAAC,MAAL,CAAY,CAAZ,CAAxB;AACA,SAAO,CAAC,CAAC,QAAQ,CAAC,cAAT,CAAwB,eAAxB,CAAT;AACD;;AAED,SAAS,eAAT,CAAyB,IAAzB,EAAqC;AACnC,MAAM,KAAK,GAAG,IAAI,CAAC,OAAL,CAAa,GAAb,CAAd;AACA,SAAO,KAAK,GAAG,CAAR,GAAY,IAAZ,GAAmB,IAAI,CAAC,KAAL,CAAW,CAAX,EAAc,KAAd,CAA1B;AACD","sourceRoot":"","sourcesContent":["import { monitor, addEventListener } from '@datadog/browser-core';\nexport function trackLocationChanges(onLocationChange) {\n    var stopHistoryTracking = trackHistory(onLocationChange).stop;\n    var stopHashTracking = trackHash(onLocationChange).stop;\n    return {\n        stop: function () {\n            stopHistoryTracking();\n            stopHashTracking();\n        },\n    };\n}\nexport function areDifferentLocation(currentLocation, otherLocation) {\n    return (currentLocation.pathname !== otherLocation.pathname ||\n        (!isHashAnAnchor(otherLocation.hash) &&\n            getPathFromHash(otherLocation.hash) !== getPathFromHash(currentLocation.hash)));\n}\nfunction trackHistory(onHistoryChange) {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    var originalPushState = history.pushState;\n    history.pushState = monitor(function () {\n        originalPushState.apply(this, arguments);\n        onHistoryChange();\n    });\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    var originalReplaceState = history.replaceState;\n    history.replaceState = monitor(function () {\n        originalReplaceState.apply(this, arguments);\n        onHistoryChange();\n    });\n    var removeListener = addEventListener(window, \"popstate\" /* POP_STATE */, onHistoryChange).stop;\n    var stop = function () {\n        removeListener();\n        history.pushState = originalPushState;\n        history.replaceState = originalReplaceState;\n    };\n    return { stop: stop };\n}\nfunction trackHash(onHashChange) {\n    return addEventListener(window, \"hashchange\" /* HASH_CHANGE */, onHashChange);\n}\nfunction isHashAnAnchor(hash) {\n    var correspondingId = hash.substr(1);\n    return !!document.getElementById(correspondingId);\n}\nfunction getPathFromHash(hash) {\n    var index = hash.indexOf('?');\n    return index < 0 ? hash : hash.slice(0, index);\n}\n//# sourceMappingURL=trackLocationChanges.js.map"]},"metadata":{},"sourceType":"module"}